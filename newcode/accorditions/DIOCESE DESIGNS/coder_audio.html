<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pixabay Music Player â€” Improved Modal & Cards</title>

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body { background: #f2f5f9; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }

    /* SONG CARDS */
    .songs-row { margin-top: 10px; }
    .song-card {
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      cursor: pointer;
      transition: transform .22s ease, box-shadow .22s ease;
      background: #fff;
      box-shadow: 0 6px 18px rgba(17,24,39,0.06);
    }
    .song-card:hover { transform: translateY(-6px); box-shadow: 0 14px 30px rgba(17,24,39,0.10); }
    .song-card img { width: 100%; height: 220px; object-fit: cover; display:block; border-radius: 12px 12px 0 0; }
    .song-card .card-body {
      padding: .65rem .75rem;
      text-align: left;
    }
    .song-card .title { font-weight: 600; font-size: 0.95rem; margin:0; color:#111827; }
    .song-card .artist { font-size: .85rem; color:#6b7280; margin: 2px 0 0; }

    .song-overlay {
      position: absolute;
      inset: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,0.42);
      opacity: 0;
      transition: opacity .22s ease;
    }
    .song-card:hover .song-overlay { opacity: 1; }
    .song-overlay i { font-size: 42px; color: white; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.45)); }

    /* MODAL PLAYER (sleek card like your screenshot) */
    .modal .music-player {
      display:flex;
      gap: 20px;
      background: linear-gradient(180deg,#262a34 0%, #1f2328 100%);
      color: #fff;
      padding: 22px;
      border-radius: 14px;
      align-items: center;
      box-shadow: 0 18px 50px rgba(2,6,23,0.35);
    }
    .mp-album { width: 220px; height: 220px; border-radius: 10px; object-fit: cover; flex-shrink:0; box-shadow: 0 8px 30px rgba(0,0,0,0.5); }
    .mp-right { flex:1; min-width: 260px; }
    .mp-right h4 { margin:0; font-size:1.25rem; font-weight:700; color:#f8fafc; }
    .mp-right p.artist { margin:0; color:#cbd5e1; font-size:.95rem; }
    .meta-grid { margin-top: 12px; display:flex; gap:12px; flex-wrap:wrap; color:#cbd5e1; font-size:.9rem; }
    .meta-grid .meta-item { min-width: 140px; opacity:.95; }

    .time-row { display:flex; align-items:center; gap:12px; margin-top: 14px; color:#cbd5e1; font-size:.9rem; }
    .time-row .times { width:72px; text-align:center; color:#9ca3af; font-size:.85rem; }

    .progress-wrap { display:flex; align-items:center; gap:12px; margin-top:10px; }
    .progress-wrap input[type="range"] {
      -webkit-appearance: none; appearance:none; height:6px; border-radius:6px; background: rgba(255,255,255,0.12); outline:none; flex:1;
    }
    .progress-wrap input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance:none; width:14px; height:14px; border-radius:50%; background: linear-gradient(180deg,#fff,#d1d5db); box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }

    .mp-controls { display:flex; gap:14px; align-items:center; justify-content:center; margin-top:12px; }
    .mp-controls button {
      background: rgba(255,255,255,0.06); border: none; color: #fff; width:48px; height:48px; border-radius:50%; font-size:18px;
      display:inline-flex; align-items:center; justify-content:center; transition: transform .14s ease, background .14s;
    }
    .mp-controls button:hover { transform: scale(1.06); background: rgba(255,255,255,0.12); }

    .volume-row { display:flex; align-items:center; gap:12px; margin-top:12px; color:#cbd5e1; }
    .volume-row input[type="range"] { width:160px; -webkit-appearance:none; height:6px; border-radius:6px; background: rgba(255,255,255,0.08); }
    .volume-row input[type="range"]::-webkit-slider-thumb { -webkit-appearance:none; width:12px; height:12px; border-radius:50%; background:#fff; box-shadow: 0 2px 6px rgba(0,0,0,.4); }

    @media (max-width:820px){
      .music-player { flex-direction:column; padding:18px; }
      .mp-album { width:100%; height:220px; }
      .mp-right { width:100%; }
    }
  </style>
</head>
<body>

<div class="container py-4">
  <h2 class="mb-3 text-center">ðŸŽµ Free Pixabay Songs â€” Player (improved)</h2>

  <div class="row songs-row g-4">
    <!-- JS will render cards here -->
  </div>
</div>

<!-- Player Modal -->
<div class="modal fade" id="musicModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-transparent border-0">
      <div class="music-player">
        <img id="mpAlbum" class="mp-album" src="" alt="Album art">
        <div class="mp-right">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h4 id="mpTitle">Song Title</h4>
              <p class="artist" id="mpArtist">Artist Name</p>
            </div>
            <!-- modal close -->
            <button type="button" class="btn btn-sm btn-close text-white" data-bs-dismiss="modal" aria-label="Close" style="background:transparent; border:none; filter: brightness(150%);"></button>
          </div>

          <div class="meta-grid" id="mpMeta">
            <!-- Album / Composer / Director / Genre will be injected -->
          </div>

          <div class="time-row">
            <div class="times" id="mpCurrent">0:00</div>
            <div style="flex:1">
              <div class="progress-wrap">
                <input type="range" id="mpProgress" min="0" value="0" step="0.1">
              </div>
            </div>
            <div class="times" id="mpDuration">0:00</div>
          </div>

          <div class="mp-controls">
            <button id="mpPrev" title="Previous"><i class="bi bi-skip-backward-fill"></i></button>
            <button id="mpPlay" title="Play / Pause"><i class="bi bi-play-fill"></i></button>
            <button id="mpNext" title="Next"><i class="bi bi-skip-forward-fill"></i></button>
            <button id="mpStop" title="Stop"><i class="bi bi-stop-fill"></i></button>
          </div>

          <div class="volume-row">
            <i class="bi bi-volume-down-fill"></i>
            <input id="mpVolume" type="range" min="0" max="1" step="0.01" value="1">
            <div style="flex:1"></div>
            <small style="color:#9ca3af">Autoplay: <span id="mpAutoplay">On</span></small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ---------- SONG DATA (Pixabay free audio example files) ---------- */
const songs = [
  {
    title: "Inspiring Background",
    artist: "AudioCoffee",
    album: "Free Album",
    composer: "AudioCoffee",
    director: "Pixabay",
    genre: "Corporate",
    image: "https://picsum.photos/seed/song1/900/900",
    src: "accorditions/DIOCESE DESIGNS/vlog-beat-background-349853.mp3"
  },
  {
    title: "Happy Clappy Ukulele",
    artist: "PenguinMusic",
    album: "Fun Album",
    composer: "PenguinMusic",
    director: "Pixabay",
    genre: "Ukulele / Happy",
    image: "https://picsum.photos/seed/song2/900/900",
    src: "accorditions/DIOCESE DESIGNS/vlog-beat-background-349853.mp3"
  },
  {
    title: "Relaxing Piano",
    artist: "Alex-Productions",
    album: "Calm Vibes",
    composer: "Alex-Productions",
    director: "Pixabay",
    genre: "Piano / Relax",
    image: "https://picsum.photos/seed/song3/900/900",
    src: "accorditions/DIOCESE DESIGNS/eona-emotional-ambient-pop-351436.mp3"
  }
];

/* ---------- DOM ELEMENTS ---------- */
const songsRow = document.querySelector('.songs-row');
const modalEl = document.getElementById('musicModal');
const modal = new bootstrap.Modal(modalEl, { keyboard: true });

const mpAlbum = document.getElementById('mpAlbum');
const mpTitle = document.getElementById('mpTitle');
const mpArtist = document.getElementById('mpArtist');
const mpMeta = document.getElementById('mpMeta');
const mpCurrent = document.getElementById('mpCurrent');
const mpDuration = document.getElementById('mpDuration');
const mpProgress = document.getElementById('mpProgress');
const mpPlay = document.getElementById('mpPlay');
const mpPrev = document.getElementById('mpPrev');
const mpNext = document.getElementById('mpNext');
const mpStop = document.getElementById('mpStop');
const mpVolume = document.getElementById('mpVolume');
const mpAutoplayLabel = document.getElementById('mpAutoplay');

/* ---------- AUDIO & STATE ---------- */
const audio = new Audio();
audio.preload = 'metadata';
let currentIndex = 0;
let autoplayNext = true;

/* ---------- RENDER CARDS ---------- */
function renderCards() {
  songs.forEach((s, i) => {
    const col = document.createElement('div');
    col.className = 'col-md-4';
    col.innerHTML = `
      <div class="song-card" role="button" aria-pressed="false" tabindex="0" data-index="${i}">
        <img src="${s.image}" alt="${escapeHtml(s.title)}">
        <div class="song-overlay"><i class="bi bi-music-note-beamed"></i></div>
        <div class="card-body">
          <p class="title">${escapeHtml(s.title)}</p>
          <p class="artist">${escapeHtml(s.artist)}</p>
        </div>
      </div>
    `;
    // click and keyboard support
    col.querySelector('.song-card').addEventListener('click', () => openPlayer(i));
    col.querySelector('.song-card').addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openPlayer(i); }});
    songsRow.appendChild(col);
  });
}

/* ---------- PLAYER CONTROL FUNCTIONS ---------- */
function openPlayer(index) {
  currentIndex = index;
  loadSong(currentIndex, true);
  modal.show();
  // focus play button for accessibility
  setTimeout(()=> mpPlay.focus(), 260);
}

function loadSong(index, autoplay = false) {
  const s = songs[index];
  if (!s) return;
  mpAlbum.src = s.image;
  mpTitle.textContent = s.title;
  mpArtist.textContent = s.artist;

  // meta grid
  mpMeta.innerHTML = `
    <div class="meta-item"><strong>Album:</strong><div>${escapeHtml(s.album)}</div></div>
    <div class="meta-item"><strong>Composer:</strong><div>${escapeHtml(s.composer)}</div></div>
    <div class="meta-item"><strong>Director:</strong><div>${escapeHtml(s.director)}</div></div>
    <div class="meta-item"><strong>Genre:</strong><div>${escapeHtml(s.genre)}</div></div>
  `;

  audio.src = s.src;
  audio.currentTime = 0;
  audio.load();
  // set volume UI
  audio.volume = parseFloat(mpVolume.value);
  // update UI when metadata loads
  audio.onloadedmetadata = () => {
    mpProgress.max = Math.floor(audio.duration || 0);
    mpDuration.textContent = formatTime(audio.duration);
    mpCurrent.textContent = formatTime(0);
    if (autoplay) audio.play().catch(()=>{}); // catch autoplay block errors
  };
}

function playPause() {
  if (audio.paused) {
    audio.play().catch(()=>{}); // ignore errors if autoplay blocked
  } else {
    audio.pause();
  }
  updatePlayIcon();
}
function stop() { audio.pause(); audio.currentTime = 0; updatePlayIcon(); }
function prevSong() {
  currentIndex = (currentIndex - 1 + songs.length) % songs.length;
  loadSong(currentIndex, true);
}
function nextSong() {
  currentIndex = (currentIndex + 1) % songs.length;
  loadSong(currentIndex, true);
}

/* ---------- EVENTS ---------- */
// Update UI on play/pause
audio.addEventListener('play', updatePlayIcon);
audio.addEventListener('pause', updatePlayIcon);

// Time update
audio.addEventListener('timeupdate', () => {
  mpProgress.value = Math.floor(audio.currentTime || 0);
  mpCurrent.textContent = formatTime(audio.currentTime);
});

// Seek using slider
mpProgress.addEventListener('input', (e) => {
  audio.currentTime = Number(e.target.value);
});

// Volume change
mpVolume.addEventListener('input', (e) => {
  audio.volume = Number(e.target.value);
});

// When ended -> autoplay next track if enabled
audio.addEventListener('ended', () => {
  if (autoplayNext) nextSong();
});

// Update autoplay label (you can toggle this in future UI)
mpAutoplayLabel.textContent = autoplayNext ? 'On' : 'Off';

// Buttons
mpPlay.addEventListener('click', playPause);
mpPrev.addEventListener('click', prevSong);
mpNext.addEventListener('click', nextSong);
mpStop.addEventListener('click', () => { stop(); });

// Pause when modal hidden
modalEl.addEventListener('hidden.bs.modal', () => {
  audio.pause();
  updatePlayIcon();
});

/* ---------- HELPERS ---------- */
function updatePlayIcon(){
  if (audio.paused) {
    mpPlay.innerHTML = `<i class="bi bi-play-fill"></i>`;
  } else {
    mpPlay.innerHTML = `<i class="bi bi-pause-fill"></i>`;
  }
}
function formatTime(sec) {
  if (!sec || isNaN(sec) || !isFinite(sec)) return '0:00';
  const m = Math.floor(sec/60);
  const s = Math.floor(sec%60);
  return `${m}:${s < 10 ? '0' : ''}${s}`;
}
function escapeHtml(text){
  if (!text) return '';
  return text.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
}

/* ---------- INIT ---------- */
renderCards();
// preload first track metadata (optional)
loadSong(0, false);
updatePlayIcon();

</script>
</body>
</html>
